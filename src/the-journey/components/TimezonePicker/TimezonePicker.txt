import React, { ChangeEvent, useState } from 'react';
import { MenuItem, Select } from '@material-ui/core';
import { timezones } from '../../utils/foh';

const currentZone = Intl.DateTimeFormat().resolvedOptions().timeZone
const currentCountry = currentZone && currentZone.split('/')[0]
const zones = timezones.sort((a, b) => {
  if (currentZone && currentZone === a) {
    return -1
  }
  if (
    currentCountry &&
    (a.includes(currentCountry) && !b.includes(currentCountry))
  ) {
    return -1
  }
  return 0
})

interface TimezonePickerProps {
  id?: string,
  onChange?: (e: ChangeEvent) => void,
}
const TimezonePicker = ({ id, onChange }: TimezonePickerProps) => {
  const [input, setInput] = useState<string>(currentZone);
  function handleChange(e) {
    setInput(e.target.value);

  }

  return (
    <Select id={id} onChange={handleChange} value={input}>
      {zones.map(timezone => (
        <MenuItem key={timezone} value={timezone}>
          {timezone}
        </MenuItem>
      ))}
    </Select>
  )
}

export default TimezonePicker
